<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="page-title" data-i18n="dangerous_page_title">H√¶ttulegar a√∞ger√∞ir - Kerfisstj√≥rn</title>

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">

  <!-- Reuse member portal styles -->
  <link rel="stylesheet" href="/styles/bundle.css?v=20251217k">

  <!-- Superuser-specific styles -->
  <link rel="stylesheet" href="/superuser/styles/superuser.css?v=20260118a">
</head>
<body class="authenticated superuser">
  <!-- Navigation component inserted here -->

  <!-- Page Content -->
  <div class="page__container">
    <!-- Warning Card -->
    <div class="card dangerous-ops-warning">
      <div class="dangerous-ops-warning__icon">‚ö†Ô∏è</div>
      <p class="card__description" data-i18n="dangerous_ops_warning">
        A√∞ger√∞ir √° √æessari s√≠√∞u eru √ìAFTURKR√ÜFAR. √û√¶r geta eytt g√∂gnum varanlega
        e√∞a gert √æa√∞ √≥m√∂gulegt a√∞ endurheimta uppl√Ωsingar. Vinsamlegast far√∞u varlega.
      </p>
    </div>

    <!-- Tab Navigation -->
    <div class="dangerous-tabs">
      <button class="dangerous-tabs__tab dangerous-tabs__tab--active" data-tab="delete" type="button">
        <span class="dangerous-tabs__icon">üóëÔ∏è</span>
        Ey√∞a f√©laga
      </button>
      <button class="dangerous-tabs__tab" data-tab="anonymize" type="button">
        <span class="dangerous-tabs__icon">üë§</span>
        Nafnhreinsa
      </button>
    </div>

    <!-- Tab Content: Delete Member -->
    <div class="dangerous-tabs__content dangerous-tabs__content--active" id="tab-delete">
      <div class="dangerous-ops__layout">
        <!-- Left: Deleted Members Table -->
        <div class="dangerous-ops__table-section">
          <h3 class="dangerous-ops__section-title">Eyddir f√©lagar (soft-deleted)</h3>
          <p class="dangerous-ops__section-desc">Smelltu √° r√∂√∞ til a√∞ velja f√©laga</p>

          <div class="dangerous-ops__stats">
            <span class="dangerous-ops__stat">
              <strong id="deleted-count-delete">0</strong> f√©lagar
            </span>
          </div>

          <div class="table-container">
            <table class="data-table data-table--compact data-table--selectable">
              <thead>
                <tr>
                  <th class="data-table__th--checkbox"></th>
                  <th>Nafn</th>
                  <th>Kennitala</th>
                  <th>Eytt √æann</th>
                </tr>
              </thead>
              <tbody id="deleted-members-tbody-delete">
                <!-- Populated by JavaScript -->
              </tbody>
            </table>
          </div>
          <p class="dangerous-ops__empty-state" id="no-deleted-delete" style="display: none;">
            Engir eyddir f√©lagar fundust.
          </p>
        </div>

        <!-- Right: Action Panel -->
        <div class="dangerous-ops__action-section">
          <div class="card card--danger">
            <h3 class="card__title" data-i18n="dangerous_delete_title">Ey√∞a f√©laga varanlega</h3>
            <p class="card__description" data-i18n="dangerous_delete_desc">
              Ey√∞ir f√©laga algj√∂rlega √∫r kerfinu. √ûetta fjarl√¶gir √∂ll g√∂gn √∫r Firestore, Firebase Auth
              og tengdar skr√°r. Ekki er h√¶gt a√∞ afturkalla √æessa a√∞ger√∞.
            </p>

            <!-- Preview Panel -->
            <div class="dangerous-ops__preview" id="preview-delete" style="display: none;">
              <h4 class="dangerous-ops__preview-title">Valinn f√©lagi</h4>
              <dl class="dangerous-ops__preview-data">
                <dt>Nafn</dt>
                <dd id="preview-name-delete">-</dd>
                <dt>Kennitala</dt>
                <dd id="preview-kt-delete">-</dd>
                <dt>Eytt √æann</dt>
                <dd id="preview-date-delete">-</dd>
              </dl>
              <div class="dangerous-ops__preview-warning">
                <strong>Ver√∞ur eytt varanlega:</strong>
                <ul>
                  <li>Firebase Auth account</li>
                  <li>Firestore /users document</li>
                  <li>Cloud SQL record</li>
                </ul>
              </div>
            </div>

            <div class="dangerous-ops__form">
              <div class="form__group">
                <label class="form__label" for="delete-member-id">Kennitala f√©laga</label>
                <input type="text" id="delete-member-id" class="form__input"
                       placeholder="Veldu √∫r t√∂flu e√∞a sl√°√∞u inn" maxlength="10" pattern="[0-9]{10}">
                <span class="form__hint">10 stafa kennitala</span>
              </div>

              <button type="button" class="btn btn--danger btn--full" id="delete-member-btn" disabled>
                üóëÔ∏è Ey√∞a f√©laga varanlega
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab Content: Anonymize Member -->
    <div class="dangerous-tabs__content" id="tab-anonymize">
      <div class="dangerous-ops__layout">
        <!-- Left: Deleted Members Table -->
        <div class="dangerous-ops__table-section">
          <h3 class="dangerous-ops__section-title">Eyddir f√©lagar (soft-deleted)</h3>
          <p class="dangerous-ops__section-desc">Smelltu √° r√∂√∞ til a√∞ velja f√©laga</p>

          <div class="dangerous-ops__stats">
            <span class="dangerous-ops__stat">
              <strong id="deleted-count-anonymize">0</strong> f√©lagar
            </span>
          </div>

          <div class="table-container">
            <table class="data-table data-table--compact data-table--selectable">
              <thead>
                <tr>
                  <th class="data-table__th--checkbox"></th>
                  <th>Nafn</th>
                  <th>Kennitala</th>
                  <th>Eytt √æann</th>
                </tr>
              </thead>
              <tbody id="deleted-members-tbody-anonymize">
                <!-- Populated by JavaScript -->
              </tbody>
            </table>
          </div>
          <p class="dangerous-ops__empty-state" id="no-deleted-anonymize" style="display: none;">
            Engir eyddir f√©lagar fundust.
          </p>
        </div>

        <!-- Right: Action Panel -->
        <div class="dangerous-ops__action-section">
          <div class="card card--warning">
            <h3 class="card__title" data-i18n="dangerous_anon_title">Nafnhreinsa f√©laga (GDPR)</h3>
            <p class="card__description" data-i18n="dangerous_anon_desc">
              Fjarl√¶gir pers√≥nugreinanlegar uppl√Ωsingar en heldur t√∂lfr√¶√∞ilegum g√∂gnum.
              Nota√∞ fyrir GDPR bei√∞nir √æar sem ey√∞ing er ekki m√∂guleg vegna lagaskyldu.
            </p>

            <!-- Preview Panel -->
            <div class="dangerous-ops__preview" id="preview-anonymize" style="display: none;">
              <h4 class="dangerous-ops__preview-title">Valinn f√©lagi</h4>
              <dl class="dangerous-ops__preview-data">
                <dt>Nafn</dt>
                <dd id="preview-name-anonymize">-</dd>
                <dt>Kennitala</dt>
                <dd id="preview-kt-anonymize">-</dd>
                <dt>Eytt √æann</dt>
                <dd id="preview-date-anonymize">-</dd>
              </dl>
              <div class="dangerous-ops__preview-warning dangerous-ops__preview-warning--info">
                <strong>Ver√∞ur nafnhreinsa√∞:</strong>
                <ul>
                  <li>Nafn ‚Üí ANON-xxxxx</li>
                  <li>Netfang ‚Üí anon@anonymized.local</li>
                  <li>Kennitala eytt</li>
                  <li>T√∂lfr√¶√∞ileg g√∂gn var√∞veitt</li>
                </ul>
              </div>
            </div>

            <div class="dangerous-ops__form">
              <div class="form__group">
                <label class="form__label" for="anonymize-member-id">Kennitala f√©laga</label>
                <input type="text" id="anonymize-member-id" class="form__input"
                       placeholder="Veldu √∫r t√∂flu e√∞a sl√°√∞u inn" maxlength="10" pattern="[0-9]{10}">
                <span class="form__hint">10 stafa kennitala</span>
              </div>

              <button type="button" class="btn btn--warning btn--full" id="anonymize-member-btn" disabled>
                üë§ Nafnhreinsa f√©laga
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Audit Trail -->
    <div class="card">
      <h2 class="card__title" data-i18n="dangerous_recent_title">N√Ωlegar h√¶ttulegar a√∞ger√∞ir</h2>
      <div class="dangerous-ops__audit" id="recent-dangerous-ops">
        <p class="u-text-muted" data-i18n="dangerous_loading">Hle√∞ur...</p>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div class="modal" id="confirm-modal" aria-hidden="true">
    <div class="modal__backdrop"></div>
    <div class="modal__container modal__container--danger">
      <div class="modal__header">
        <h2 class="modal__title" id="confirm-modal-title" data-i18n="dangerous_modal_title">Sta√∞festa a√∞ger√∞</h2>
      </div>
      <div class="modal__body">
        <p id="confirm-modal-description"></p>

        <!-- Step 1: Countdown -->
        <div class="confirm-step" id="confirm-step-1">
          <p class="confirm-step__instruction" data-i18n="dangerous_modal_step1">B√≠√∞√∞u eftir ni√∞urtalningu:</p>
          <div class="confirmation-countdown" id="confirm-countdown">5</div>
        </div>

        <!-- Step 2: Type confirmation -->
        <div class="confirm-step u-hidden" id="confirm-step-2">
          <p class="confirm-step__instruction">Sl√°√∞u inn "<span id="confirm-phrase"></span>" til a√∞ sta√∞festa:</p>
          <input type="text" class="confirmation-input" id="confirm-input" autocomplete="off">
        </div>

        <!-- Step 3: Final confirmation -->
        <div class="confirm-step u-hidden" id="confirm-step-3">
          <p class="confirm-step__instruction confirm-step__instruction--final" data-i18n="dangerous_modal_step3">
            √ûetta er s√≠√∞asta t√¶kif√¶ri til a√∞ h√¶tta vi√∞. Ertu alveg viss?
          </p>
        </div>
      </div>
      <div class="modal__footer">
        <button type="button" class="btn btn--outline" id="confirm-cancel-btn" data-i18n="dangerous_modal_cancel">H√¶tta vi√∞</button>
        <button type="button" class="btn btn--danger" id="confirm-proceed-btn" disabled data-i18n="dangerous_modal_proceed">Halda √°fram</button>
      </div>
    </div>
  </div>

  <script type="module" src="/superuser/js/dangerous-ops.js?v=20260110b"></script>

  <!-- Initialize Navigation Component -->
  <script type="module">
    import { initNavHeader, NAV_CONFIGS } from '../ui/components/navigation-bar.js?v=20251201';
    await initNavHeader(NAV_CONFIGS.superuserDangerousOps);
  </script>

</body>
</html>
