<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="page-title">Loading...</title>

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">

  <!-- Reuse member portal styles -->
  <link rel="stylesheet" href="/styles/bundle.css?v=20251215k">
  <link rel="stylesheet" href="/styles/components/profile-edit.css?v=20251105">
  <link rel="stylesheet" href="/styles/components/address-autocomplete.css?v=20251125">
  <link rel="stylesheet" href="/styles/components/searchable-select.css?v=20251105">

  <!-- Admin-specific styles -->
  <link rel="stylesheet" href="/admin/styles/admin.css">
  <link rel="stylesheet" href="/admin/styles/admin-shared.css">

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body class="authenticated admin">
  <!-- Navigation component inserted here -->

  <!-- Main Content -->
  <main class="page">
    <div class="page__container">
      <!-- Back Navigation -->
      <div class="admin-back">
        <a href="/admin/members.html" class="admin-back__link" id="back-to-members">
          ← <span id="back-to-members-text"></span>
        </a>
      </div>

      <!-- Note: Page title removed - nav brand shows context -->

      <!-- Loading State -->
      <div id="member-loading" class="admin-loading">
        <div class="spinner"></div>
        <p id="member-loading-text"></p>
      </div>

      <!-- Error State -->
      <div id="member-error" class="admin-error hidden">
        <p class="admin-error__message" id="member-error-message"></p>
        <button class="btn btn--secondary" id="btn-retry"></button>
      </div>

      <!-- Not Found State -->
      <div id="member-not-found" class="admin-not-found hidden">
        <p class="admin-not-found__message" id="member-not-found-message"></p>
        <a href="/admin/members.html" class="btn btn--secondary" id="btn-back-to-members"></a>
      </div>

      <!-- Member Profile -->
      <div id="member-profile" class="hidden">
        <!-- Basic Information -->
        <div class="card">
          <h3 class="card__title" id="section-personal-info"></h3>
          <div class="info-grid">
            <!-- Name -->
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-name"></div>
              <div class="profile-field">
                <input
                  type="text"
                  class="profile-field__input"
                  id="input-name"
                  name="name"
                  required
                  maxlength="100"
                />
                <span class="profile-field__status" id="status-name" aria-live="polite" aria-atomic="true"></span>
                <span class="profile-field__error" id="error-name" role="alert"></span>
              </div>
            </div>

            <!-- Kennitala (readonly) -->
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-kennitala"></div>
              <div class="info-grid__value" id="value-kennitala">-</div>
            </div>

            <!-- Email -->
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-email"></div>
              <div class="profile-field">
                <input
                  type="email"
                  class="profile-field__input"
                  id="input-email"
                  name="email"
                  placeholder=""
                />
                <span class="profile-field__status" id="status-email" aria-live="polite" aria-atomic="true"></span>
                <span class="profile-field__error" id="error-email" role="alert"></span>
              </div>
            </div>

            <!-- Birthday -->
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-birthday"></div>
              <div class="profile-field">
                <input
                  type="date"
                  class="profile-field__input"
                  id="input-birthday"
                  name="birthday"
                />
                <span class="profile-field__status" id="status-birthday" aria-live="polite" aria-atomic="true"></span>
                <span class="profile-field__error" id="error-birthday" role="alert"></span>
              </div>
            </div>

            <!-- Gender -->
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-gender"></div>
              <div class="profile-field">
                <select id="input-gender" name="gender" class="profile-field__input" data-searchable>
                  <option value="" id="option-gender-none"></option>
                  <option value="0" id="option-gender-m"></option>
                  <option value="1" id="option-gender-f"></option>
                </select>
                <span class="profile-field__status" id="status-gender" aria-live="polite" aria-atomic="true"></span>
                <span class="profile-field__error" id="error-gender" role="alert"></span>
              </div>
            </div>
          </div>
        </div>

        <!-- Phone Numbers -->
        <div class="card">
          <h3 class="card__title expandable" id="label-phone-numbers">
            <span id="phone-numbers-title"></span>
            <span class="expand-icon" id="phone-expand-icon">▼</span>
          </h3>

          <!-- Simple Display (collapsed) -->
          <div class="info-grid__value" id="value-phone-simple">-</div>

          <!-- Expanded Section -->
          <div id="phone-numbers-section" class="hidden">
            <div id="phone-numbers-list"></div>
            <button type="button" class="btn btn--secondary" id="btn-add-phone">
              <span id="btn-add-phone-text"></span>
            </button>
            <span class="profile-field__status" id="status-phone-numbers"></span>
          </div>
        </div>

        <!-- Addresses -->
        <div class="card">
          <h3 class="card__title expandable" id="label-addresses">
            <span id="addresses-title"></span>
            <span class="expand-icon" id="address-expand-icon">▼</span>
          </h3>

          <!-- Simple Display (collapsed) -->
          <div class="info-grid__value" id="value-address-simple">-</div>

          <!-- Expanded Section -->
          <div id="addresses-section" class="hidden">
            <div id="addresses-list"></div>
            <button type="button" class="btn btn--secondary" id="btn-add-address">
              <span id="btn-add-address-text"></span>
            </button>
            <span class="profile-field__status" id="status-addresses"></span>
          </div>
        </div>

        <!-- Communication Preferences -->
        <div class="card">
          <h3 class="card__title" id="section-communication"></h3>
          <div class="info-grid">
            <!-- Reachable toggle -->
            <div class="info-grid__item info-grid__item--full">
              <div class="profile-field profile-field--toggle">
                <label class="toggle-field">
                  <input type="checkbox" id="input-reachable" name="reachable" class="toggle-field__input">
                  <span class="toggle-field__switch"></span>
                  <span class="toggle-field__label">
                    <span id="label-reachable"></span>
                    <span class="toggle-field__description" id="label-reachable-description"></span>
                  </span>
                </label>
                <span class="profile-field__status" id="status-reachable" aria-live="polite" aria-atomic="true"></span>
              </div>
            </div>

            <!-- Groupable toggle -->
            <div class="info-grid__item info-grid__item--full">
              <div class="profile-field profile-field--toggle">
                <label class="toggle-field">
                  <input type="checkbox" id="input-groupable" name="groupable" class="toggle-field__input">
                  <span class="toggle-field__switch"></span>
                  <span class="toggle-field__label">
                    <span id="label-groupable"></span>
                    <span class="toggle-field__description" id="label-groupable-description"></span>
                  </span>
                </label>
                <span class="profile-field__status" id="status-groupable" aria-live="polite" aria-atomic="true"></span>
              </div>
            </div>
          </div>
        </div>

        <!-- Additional Membership Info -->
        <div class="card">
          <h3 class="card__title" id="section-membership-details">Félagsupplýsingar</h3>
          <div class="info-grid">
            <!-- Svæði (readonly) -->
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-cell">Svæði</div>
              <div class="info-grid__value" id="value-cell">-</div>
            </div>

            <!-- Union -->
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-union">Stéttarfélag</div>
              <div class="profile-field">
                <select id="input-union" name="union" class="profile-field__input">
                  <option value="">Veldu stéttarfélag...</option>
                </select>
                <span class="profile-field__status" id="status-union" aria-live="polite" aria-atomic="true"></span>
              </div>
            </div>

            <!-- Job Title -->
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-title">Starfsheiti</div>
              <div class="profile-field">
                <select id="input-title" name="title" class="profile-field__input">
                  <option value="">Veldu starfsheiti...</option>
                </select>
                <span class="profile-field__status" id="status-title" aria-live="polite" aria-atomic="true"></span>
              </div>
            </div>

            <!-- Housing Situation -->
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-housing">Húsnæðisaðstæður</div>
              <div class="profile-field">
                <select id="input-housing" name="housing" class="profile-field__input">
                  <option value="">Veldu...</option>
                  <option value="0">Á íbúð, engar eftirstöðvar</option>
                  <option value="1">Á íbúð, eftirstöðvar af láni</option>
                  <option value="2">Leigi ein(n) eða með maka/fjölskyldu</option>
                  <option value="3">Leigi með meðleigjendum</option>
                  <option value="4">Dvel hjá ættingjum/vinum</option>
                  <option value="5">Dvel í húsi í leyfisleysi</option>
                  <option value="6">Heimilislaus</option>
                </select>
                <span class="profile-field__status" id="status-housing" aria-live="polite" aria-atomic="true"></span>
              </div>
            </div>
          </div>
        </div>

        <!-- Membership Info (readonly) -->
        <div class="card">
          <h3 class="card__title" id="section-membership"></h3>
          <div class="info-grid">
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-status"></div>
              <div class="info-grid__value" id="value-status">
                <span class="admin-badge" id="status-badge">-</span>
              </div>
            </div>
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-joined"></div>
              <div class="info-grid__value" id="value-joined">-</div>
            </div>
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-member-since">Félagi í</div>
              <div class="info-grid__value" id="value-member-since">-</div>
            </div>
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-django-id"></div>
              <div class="info-grid__value" id="value-django-id">-</div>
            </div>
            <div class="info-grid__item">
              <div class="info-grid__label" id="label-synced-at"></div>
              <div class="info-grid__value" id="value-synced-at">-</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Scripts -->
  <script type="module" src="/admin/js/member-profile.js?v=20251212"></script>

  <!-- Initialize Navigation Component -->
  <script type="module">
    import { initNavHeader, NAV_CONFIGS } from '../../ui/components/navigation-bar.js?v=20251122';
    
    // Initialize navigation with appropriate config
    await initNavHeader(NAV_CONFIGS.adminMemberProfile);
  </script>

</body>
</html>
